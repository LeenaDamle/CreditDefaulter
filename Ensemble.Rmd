---
title: "R Notebook"
output: html_notebook
---
```{r, eval=FALSE}
#https://archive.ics.uci.edu/ml/machine-learning-databases/00350/default%20of%20credit%20card%20clients.xls
#Step 1: Collect data
credit <- read.csv("default_of_credit_card_clients_1.csv")
set.seed(124)
```
#In the csv file used- default_of_credit_card_clients_1.csv, column names X1, X2... are discarded to keep only the more meaningful names given in row2- LIMIT_BAL, SEX.. present in the second row
#remove the ID variable to avoid overfitting and remove factor names additionally present in row


```{r, eval=FALSE}
credit<-credit[,-1]
credit2 <- credit
credit2[,c(2:4,6:11,24)] <- lapply(credit[,c(2:4,6:11,24)], as.factor)
library(caret)
TrainingDataIndex <- createDataPartition(credit2$default.payment.next.month, p=0.75, list = FALSE)
# Create Training Data
trainingData <- credit2[TrainingDataIndex,]
testData <- credit2[-TrainingDataIndex,]
#standardized data
trainingData_standardized<-trainingData
trainingData_standardized[,c(1,5,12:22)] <-scale(trainingData_standardized[,c(1,5,12:22)])
testData_standardized<-testData
testData_standardized[,c(1,5,12:22)] <-scale(testData_standardized[,c(1,5,12:22)])

```
```{r}
library(plyr)
revalue(credit2$SEX, c("1" = "male", "2" = "female"))
revalue(credit2$EDUCATION, c("0"="zero","1"="one","2"="two", "3"="three", "4"="four","5"="five", "6"="six"))
revalue(credit2$MARRIAGE, c("0"="zero","1"="one","2"="two", "3"="three", "4"="four"))
revalue(credit2$PAY_0, c("-2"="zero","-1"="one","0"="two", "1"="three", "2"="four","3"="five", "4"="six","5"="seven","6"="eight","7"="nine", "8"="ten"))
revalue(credit2$PAY_2, c("-2"="zero","-1"="one","0"="two", "1"="three", "2"="four","3"="five", "4"="six","5"="seven","6"="eight","7"="nine", "8"="ten"))
revalue(credit2$PAY_3, c("-2"="zero","-1"="one","0"="two", "1"="three", "2"="four","3"="five", "4"="six","5"="seven","6"="eight","7"="nine", "8"="ten"))
revalue(credit2$PAY_4, c("-2"="zero","-1"="one","0"="two", "1"="three", "2"="four","3"="five", "4"="six","5"="seven","6"="eight","7"="nine", "8"="ten"))
revalue(credit2$PAY_5, c("-2"="zero","-1"="one","0"="two", "1"="three", "2"="four","3"="five", "4"="six","5"="seven","6"="eight","7"="nine", "8"="ten"))
revalue(credit2$PAY_6, c("-2"="zero","-1"="one","0"="two", "1"="three", "2"="four","3"="five", "4"="six","5"="seven","6"="eight","7"="nine", "8"="ten"))
revalue(credit2$default.payment.next.month, c("1"="default", "0"="did_not_default"))
```
summary(credit2)
```{r, eval=FALSE}
library(caretEnsemble)
econtrol <- trainControl(method="cv", number=3, summaryFunction = twoClassSummary, savePredictions=TRUE, classProbs=TRUE)
#econtrol <- trainControl(method="cv", number=5, savePredictions=TRUE, classProbs=TRUE)
#econtrol <- trainControl(method="cv", number=5, summaryFunction = twoClassSummary, savePredictions=TRUE, classProbs=TRUE,  sampling = "up")

# Create models
models <- caretList(default.payment.next.month ~., data=trainingData_standardized,
                    methodList=c("nnet", "C5.0", "nb"),
                    trControl = econtrol
)


# Lets see results. note the best performing model
results <- resamples(models)
results$values #for the 3 folds

results$metrics
summary(results)
dotplot(results) 

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
